// ==UserScript==
// @name         Octadesk to Hubspot
// @author       Caio Rodrigo
// @version      v3.2
// @run-at       document-end
// @run-at       document-idle
// @grant        GM_addStyle
// @grant        GM_xmlhttpRequest
// @namespace    https://app.octadesk.com/
// @match        https://app.octadesk.com/chat/*
// @icon         https://app.octadesk.com/images/Icons/favicon.ico
// @updateURL    https://github.com/investbank/octadesk/main/section.user.js
// @downloadURL  https://raw.githubusercontent.com/investbank/octadesk/main/section.user.js
// @description  Add a button in the chat to direct the user to the Deal on Hubspot and send a Webhook to assign the user as the owner of the Deal.
// ==/UserScript==

function a0_0x21c9(_0x4b557b,_0x5a2e06){const _0x251559=a0_0x2515();return a0_0x21c9=function(_0x21c9b6,_0xb8ff3e){_0x21c9b6=_0x21c9b6-0x155;let _0x38775c=_0x251559[_0x21c9b6];return _0x38775c;},a0_0x21c9(_0x4b557b,_0x5a2e06);}function a0_0x2515(){const _0x519d2f=['Deal\x20ID:\x20','466263204','654036494','Hubspot\x20ID\x20não\x20encontrado.','com','50588IqdXYT','684130698','521418344','121318700','includes','remove','href','#octa-navigation\x20>\x20div\x20>\x20div\x20>\x20div._navigation-footer_18j2x_1\x20>\x20div\x20>\x20div._menu_9ygbx_1._connection-manager_wd63x_5\x20>\x20div\x20>\x20div\x20>\x20span._avatar-person-details__name_pn7wi_7\x20>\x20span','1605249Kazcxu','Nome\x20do\x20negócio:\x20','224534171','36711165','689176995','246970eqsBIK','width','639891100','416784447','appendChild','innerText','a.hubspot-button','84fjdNGF','497313796','6863124SXKBvx','592619104','48MJQjPq','448802705','10vGsbRl','open','zapier','application/json','Erro\x20ao\x20enviar\x20webhook.','536328832','createElement','offsetHeight','402134392','style','#container-chat\x20>\x20main\x20>\x20section\x20>\x20div._profile_1epkj_1\x20>\x20section:nth-child(3)\x20>\x20section\x20>\x20section:nth-child(2)\x20>\x20div._fields-container_1xd1d_5\x20>\x20div:nth-child(6)\x20>\x20div\x20>\x20div._fields-container__field__box_1xd1d_45\x20>\x20div\x20>\x20span','querySelector','https','height','110lcDqEW','11528fEKzwd','/chat/','https://app.hubspot.com/contacts/5867570/record/0-3/','hubspot-button','635901253','error','Usuário\x20não\x20encontrado.','468809336','3kXhrac','711822417','3l74oda','490662201','_blank','210548907','Abrir\x20no\x20HubSpot','537759574','className','49340olGELW','722364735','402277167','694540914','offsetWidth','onclick','627397232','log','45224WXvzoC','#container-chat\x20>\x20main\x20>\x20section\x20>\x20div._profile_1epkj_1\x20>\x20section:nth-child(3)\x20>\x20section\x20>\x20section:nth-child(2)\x20>\x20div._fields-container_1xd1d_5\x20>\x20div:nth-child(1)\x20>\x20div\x20>\x20div._fields-container__field__box_1xd1d_45\x20>\x20div\x20>\x20span','602381622','responseText'];a0_0x2515=function(){return _0x519d2f;};return a0_0x2515();}(function(_0xd6d2cc,_0x14bb0e){const _0x2bd828=a0_0x21c9,_0x851739=_0xd6d2cc();while(!![]){try{const _0x50ed0d=-parseInt(_0x2bd828(0x195))/0x1*(-parseInt(_0x2bd828(0x16a))/0x2)+parseInt(_0x2bd828(0x161))/0x3*(parseInt(_0x2bd828(0x17b))/0x4)+-parseInt(_0x2bd828(0x188))/0x5*(-parseInt(_0x2bd828(0x193))/0x6)+-parseInt(_0x2bd828(0x18f))/0x7*(-parseInt(_0x2bd828(0x172))/0x8)+parseInt(_0x2bd828(0x183))/0x9+parseInt(_0x2bd828(0x158))/0xa*(parseInt(_0x2bd828(0x159))/0xb)+-parseInt(_0x2bd828(0x191))/0xc;if(_0x50ed0d===_0x14bb0e)break;else _0x851739['push'](_0x851739['shift']());}catch(_0x591600){_0x851739['push'](_0x851739['shift']());}}}(a0_0x2515,0x53149),(function(){'use strict';const _0x1ceb16=a0_0x21c9;GM_addStyle('a.hubspot-button{display:flex;margin-left:.5rem;border-top-left-radius:.75rem;border-bottom-left-radius:.75rem;--tw-bg-opacity:1;background-color:rgba(255,255,255,var(--tw-bg-opacity));--tw-shadow:0\x201px\x202px\x200\x20rgba(0,\x200,\x200,\x20.05);box-shadow:var(--tw-ring-offset-shadow,0\x200\x20#0000),var(--tw-ring-shadow,0\x200\x20#0000),var(--tw-shadow);font-family:Noto\x20Sans;font-size:.875rem;line-height:1.25rem;font-weight:500;--tw-text-opacity:1;color:rgba(79,84,100,var(--tw-text-opacity));position:absolute;top:.15%;right:.5%;z-index:1000;align-items:center;justify-content:center}');const _0x30288a={'Caio\x20Rodrigo':_0x1ceb16(0x186),'Cintia\x20França':_0x1ceb16(0x17e),'Jane\x20Silva':'123577470','Jeverson\x20Leal':_0x1ceb16(0x166),'Diego\x20Mota':_0x1ceb16(0x185),'Luna\x20Rodrigues':'260593552','Julio\x20Cezar':_0x1ceb16(0x19d),'Beatriz\x20Vitoria':_0x1ceb16(0x16c),'Raquel\x20Andressa':_0x1ceb16(0x18b),'Thalia\x20Sousa':'416784450','Thiago\x20Keiki':_0x1ceb16(0x194),'Vinicius\x20Antunes':_0x1ceb16(0x177),'Maria\x20Clara':_0x1ceb16(0x160),'Leandro\x20Soares':'482278797','Loara\x20Mikelly':_0x1ceb16(0x164),'Maria\x20Barreto':_0x1ceb16(0x190),'Lucas\x20Ruotolo':_0x1ceb16(0x17d),'Rosimeire\x20Pereira':_0x1ceb16(0x19a),'Jonathan\x20Rodrigues':_0x1ceb16(0x168),'Mariana\x20Bergara':'587785904','Carlos\x20Henrique':_0x1ceb16(0x192),'Beatriz\x20Menezes':_0x1ceb16(0x174),'Alef\x20Rodrigues':_0x1ceb16(0x170),'Matheus\x20Gomes':_0x1ceb16(0x15d),'Barbara\x20Vieira':_0x1ceb16(0x18a),'Thalyta\x20Ramos':'645970052','Igor\x20Gomes':_0x1ceb16(0x178),'Paloma\x20Caramelo':'664278537','Murilo\x20Nogueira':_0x1ceb16(0x17c),'Othavio\x20Cordeiro':_0x1ceb16(0x187),'Natalia\x20Betti':_0x1ceb16(0x16d),'Rafael\x20Spanopoulos':'703998366','Yago\x20Fagundes':'710142215','Mariana\x20Mendonça':_0x1ceb16(0x162),'Gabriel\x20Leite':_0x1ceb16(0x16b)},_0x1748e5=_0x1ceb16(0x156),_0x5ca58f='hooks',_0x2ab02a=_0x1ceb16(0x197),_0x5e8c1d=_0x1ceb16(0x17a),_0x218f7c='catch',_0x570b9f='11483048',_0x48d700=_0x1ceb16(0x163);let _0x37ce42=location['href'];function _0x52f96b(){const _0x55bf01=_0x1ceb16;location[_0x55bf01(0x181)]['includes'](_0x55bf01(0x15a))&&!location[_0x55bf01(0x181)][_0x55bf01(0x17f)]('/chat/empty')&&location[_0x55bf01(0x181)]!==_0x37ce42&&(_0x37ce42=location[_0x55bf01(0x181)],setTimeout(_0x4efd6d,0x3e8));}function _0x4efd6d(){const _0x2f0de8=_0x1ceb16,_0x375ec2=document[_0x2f0de8(0x155)](_0x2f0de8(0x18e));_0x375ec2&&_0x375ec2[_0x2f0de8(0x180)]();const _0x38a970=document[_0x2f0de8(0x155)](_0x2f0de8(0x19f)),_0x4a94dc=document['querySelector'](_0x2f0de8(0x173)),_0x48bd44=document[_0x2f0de8(0x155)](_0x2f0de8(0x182));if(_0x38a970&&_0x48bd44){const _0xa25c=_0x38a970[_0x2f0de8(0x18d)];console[_0x2f0de8(0x171)](_0x2f0de8(0x176)+_0xa25c);const _0x44bc9e=_0x48bd44[_0x2f0de8(0x18d)];console[_0x2f0de8(0x171)]('Nome\x20de\x20usuário:\x20'+_0x44bc9e);const _0x149c10=_0x4a94dc['innerText'];console[_0x2f0de8(0x171)](_0x2f0de8(0x184)+_0x149c10);const _0x46a185=_0x30288a[_0x44bc9e];if(!_0x46a185){console[_0x2f0de8(0x171)](_0x2f0de8(0x15f)),alert('Usuário\x20não\x20encontrado.');return;}const _0x343eb5=document[_0x2f0de8(0x155)]('#container-chat\x20>\x20main\x20>\x20section\x20>\x20div._profile_1epkj_1\x20>\x20section:nth-child(1)'),_0x326b46=_0x343eb5[_0x2f0de8(0x16e)],_0x35c74c=_0x343eb5[_0x2f0de8(0x19c)],_0x3d4dae=document[_0x2f0de8(0x19b)]('a');_0x3d4dae[_0x2f0de8(0x169)]=_0x2f0de8(0x15c),_0x3d4dae['href']=_0x2f0de8(0x15b)+_0xa25c,_0x3d4dae['innerText']=_0x2f0de8(0x167),_0x3d4dae[_0x2f0de8(0x19e)][_0x2f0de8(0x189)]=_0x326b46+'px',_0x3d4dae[_0x2f0de8(0x19e)][_0x2f0de8(0x157)]=_0x35c74c+'px',_0x3d4dae[_0x2f0de8(0x16f)]=function(_0x5de322){_0x5de322['preventDefault'](),_0x24045e(_0xa25c,_0x3d4dae['href'],_0x46a185,_0x149c10,_0x44bc9e);},document['body'][_0x2f0de8(0x18c)](_0x3d4dae);}else console[_0x2f0de8(0x171)](_0x2f0de8(0x179)),alert(_0x2f0de8(0x179));}function _0x24045e(_0x3af01a,_0x1fe879,_0xf6fd2e,_0x146b52,_0x283b4a){const _0x397906=_0x1ceb16;GM_xmlhttpRequest({'method':'POST','url':_0x1748e5+'://'+_0x5ca58f+'.'+_0x2ab02a+'.'+_0x5e8c1d+'/'+_0x5ca58f+'/'+_0x218f7c+'/'+_0x570b9f+'/'+_0x48d700,'headers':{'Content-Type':_0x397906(0x198)},'data':JSON['stringify']({'Deal\x20Name':_0x146b52,'Deal\x20ID':_0x3af01a,'Username':_0x283b4a,'Deal\x20owner':_0xf6fd2e}),'onload':function(_0x17e97e){const _0x3f3041=_0x397906;console['log']('Webhook\x20enviado\x20com\x20sucesso.',_0x17e97e[_0x3f3041(0x175)]),window[_0x3f3041(0x196)](_0x1fe879,_0x3f3041(0x165));},'onerror':function(_0x145445){const _0x57cf57=_0x397906;console[_0x57cf57(0x15e)](_0x57cf57(0x199),_0x145445);}});}setInterval(_0x52f96b,0x3e8);}()));