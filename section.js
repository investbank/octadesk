// ==UserScript==
// @name         Octadesk to Hubspot
// @author       Caio Rodrigo
// @version      v3.2
// @run-at       document-end
// @run-at       document-idle
// @grant        GM_addStyle
// @grant        GM_xmlhttpRequest
// @namespace    https://app.octadesk.com/
// @match        https://app.octadesk.com/chat/*
// @icon         https://app.octadesk.com/images/Icons/favicon.ico
// @updateURL    https://github.com/investbank/octadesk/main/section.user.js
// @downloadURL  https://raw.githubusercontent.com/investbank/octadesk/main/section.user.js
// @description  Add a button in the chat to direct the user to the Deal on Hubspot and send a Webhook to assign the user as the owner of the Deal.
// ==/UserScript==

function a0_0x1c19(){const _0x3dee63=['482278797','260593552','Hubspot\x20ID\x20não\x20encontrado.','Abrir\x20no\x20HubSpot','521418344','#container-chat\x20>\x20main\x20>\x20section\x20>\x20div._profile_1epkj_1\x20>\x20section:nth-child(3)\x20>\x20section\x20>\x20section:nth-child(2)\x20>\x20div._fields-container_1xd1d_5\x20>\x20div:nth-child(6)\x20>\x20div\x20>\x20div._fields-container__field__box_1xd1d_45\x20>\x20div\x20>\x20span','remove','180FDMZkT','694540914','application/json','#container-chat\x20>\x20main\x20>\x20section\x20>\x20div._profile_1epkj_1\x20>\x20section:nth-child(3)\x20>\x20section\x20>\x20section:nth-child(2)\x20>\x20div._fields-container_1xd1d_5\x20>\x20div:nth-child(1)\x20>\x20div\x20>\x20div._fields-container__field__box_1xd1d_45\x20>\x20div\x20>\x20span','href','468809336','stringify','627397232','123577470','catch','width','Deal\x20ID:\x20','76080YHKsvy','121318700','log','hubspot-button','664278537','3295kPriLq','592619104','416784447','4457UGuJWf','com','448802705','1514529YgShcO','645970052','#container-chat\x20>\x20main\x20>\x20section\x20>\x20div._profile_1epkj_1\x20>\x20section:nth-child(1)','466263204','34588FYdWGc','1127840ErqPIq','https','innerText','appendChild','height','/chat/empty','490662201','654036494','24paVrYC','preventDefault','offsetHeight','402277167','Usuário\x20não\x20encontrado.','711822417','onclick','open','11483048','46816GXawuv','createElement','POST','210548907','responseText','12eXwJsX','a.hubspot-button','body','querySelector','639891100','_blank','Webhook\x20enviado\x20com\x20sucesso.','722364735','703998366','style'];a0_0x1c19=function(){return _0x3dee63;};return a0_0x1c19();}function a0_0x526a(_0x3adb06,_0x5b96ff){const _0x1c19d7=a0_0x1c19();return a0_0x526a=function(_0x526a58,_0x3cf290){_0x526a58=_0x526a58-0x1be;let _0x5b9668=_0x1c19d7[_0x526a58];return _0x5b9668;},a0_0x526a(_0x3adb06,_0x5b96ff);}(function(_0x2e54e4,_0xd839b7){const _0x2d0997=a0_0x526a,_0x192836=_0x2e54e4();while(!![]){try{const _0x256ffa=-parseInt(_0x2d0997(0x1f6))/0x1*(-parseInt(_0x2d0997(0x1c3))/0x2)+parseInt(_0x2d0997(0x1d1))/0x3*(parseInt(_0x2d0997(0x1fd))/0x4)+-parseInt(_0x2d0997(0x1f3))/0x5*(-parseInt(_0x2d0997(0x1e2))/0x6)+-parseInt(_0x2d0997(0x1fe))/0x7+-parseInt(_0x2d0997(0x1cc))/0x8+parseInt(_0x2d0997(0x1f9))/0x9+-parseInt(_0x2d0997(0x1ee))/0xa;if(_0x256ffa===_0xd839b7)break;else _0x192836['push'](_0x192836['shift']());}catch(_0x54d93e){_0x192836['push'](_0x192836['shift']());}}}(a0_0x1c19,0x18ca7),(function(){'use strict';const _0x43e5cf=a0_0x526a;GM_addStyle('a.hubspot-button{display:flex;margin-left:.5rem;border-top-left-radius:.75rem;border-bottom-left-radius:.75rem;--tw-bg-opacity:1;background-color:rgba(255,255,255,var(--tw-bg-opacity));--tw-shadow:0\x201px\x202px\x200\x20rgba(0,\x200,\x200,\x20.05);box-shadow:var(--tw-ring-offset-shadow,0\x200\x20#0000),var(--tw-ring-shadow,0\x200\x20#0000),var(--tw-shadow);font-family:Noto\x20Sans;font-size:.875rem;line-height:1.25rem;font-weight:500;--tw-text-opacity:1;color:rgba(79,84,100,var(--tw-text-opacity));position:absolute;top:.15%;right:.5%;z-index:1000;align-items:center;justify-content:center}');const _0x4bc357={'Caio\x20Rodrigo':'36711165','Cintia\x20França':_0x43e5cf(0x1ef),'Jane\x20Silva':_0x43e5cf(0x1ea),'Jeverson\x20Leal':_0x43e5cf(0x1cf),'Diego\x20Mota':'224534171','Luna\x20Rodrigues':_0x43e5cf(0x1dc),'Julio\x20Cezar':'402134392','Beatriz\x20Vitoria':_0x43e5cf(0x1c6),'Raquel\x20Andressa':_0x43e5cf(0x1f5),'Thalia\x20Sousa':'416784450','Thiago\x20Keiki':_0x43e5cf(0x1f8),'Vinicius\x20Antunes':_0x43e5cf(0x1fc),'Maria\x20Clara':_0x43e5cf(0x1e7),'Leandro\x20Soares':_0x43e5cf(0x1db),'Loara\x20Mikelly':_0x43e5cf(0x1c1),'Maria\x20Barreto':'497313796','Lucas\x20Ruotolo':_0x43e5cf(0x1df),'Rosimeire\x20Pereira':'536328832','Jonathan\x20Rodrigues':'537759574','Mariana\x20Bergara':'587785904','Carlos\x20Henrique':_0x43e5cf(0x1f4),'Beatriz\x20Menezes':'602381622','Alef\x20Rodrigues':_0x43e5cf(0x1e9),'Matheus\x20Gomes':'635901253','Barbara\x20Vieira':_0x43e5cf(0x1d5),'Thalyta\x20Ramos':_0x43e5cf(0x1fa),'Igor\x20Gomes':_0x43e5cf(0x1c2),'Paloma\x20Caramelo':_0x43e5cf(0x1f2),'Murilo\x20Nogueira':'684130698','Othavio\x20Cordeiro':'689176995','Natalia\x20Betti':_0x43e5cf(0x1e3),'Rafael\x20Spanopoulos':_0x43e5cf(0x1d9),'Yago\x20Fagundes':'710142215','Mariana\x20Mendonça':_0x43e5cf(0x1c8),'Gabriel\x20Leite':_0x43e5cf(0x1d8)},_0x3eb433=_0x43e5cf(0x1ff),_0x32c468='hooks',_0x59c74a='zapier',_0xbacba=_0x43e5cf(0x1f7),_0x2289c1=_0x43e5cf(0x1eb),_0x3394e2=_0x43e5cf(0x1cb),_0x885346='3l74oda';let _0x553e8b=location[_0x43e5cf(0x1e6)];function _0x3f9eab(){const _0x33d838=_0x43e5cf;location[_0x33d838(0x1e6)]['includes']('/chat/')&&!location[_0x33d838(0x1e6)]['includes'](_0x33d838(0x1c0))&&location['href']!==_0x553e8b&&(_0x553e8b=location[_0x33d838(0x1e6)],setTimeout(_0x424e53,0x3e8));}function _0x424e53(){const _0x37fe07=_0x43e5cf,_0x4abcf8=document['querySelector'](_0x37fe07(0x1d2));_0x4abcf8&&_0x4abcf8[_0x37fe07(0x1e1)]();const _0x3c608a=document[_0x37fe07(0x1d4)](_0x37fe07(0x1e0)),_0x5d5229=document[_0x37fe07(0x1d4)](_0x37fe07(0x1e5)),_0x55860f=document['querySelector']('#octa-navigation\x20>\x20div\x20>\x20div\x20>\x20div._navigation-footer_18j2x_1\x20>\x20div\x20>\x20div._menu_9ygbx_1._connection-manager_wd63x_5\x20>\x20div\x20>\x20div\x20>\x20span._avatar-person-details__name_pn7wi_7\x20>\x20span');if(_0x3c608a&&_0x55860f){const _0x309d8c=_0x3c608a[_0x37fe07(0x200)];console['log'](_0x37fe07(0x1ed)+_0x309d8c);const _0xa9208d=_0x55860f['innerText'];console[_0x37fe07(0x1f0)]('Nome\x20de\x20usuário:\x20'+_0xa9208d);const _0x4673fb=_0x5d5229[_0x37fe07(0x200)];console['log']('Nome\x20do\x20negócio:\x20'+_0x4673fb);const _0x19f359=_0x4bc357[_0xa9208d];if(!_0x19f359){console['log']('Usuário\x20não\x20encontrado.'),alert(_0x37fe07(0x1c7));return;}const _0x58225d=document[_0x37fe07(0x1d4)](_0x37fe07(0x1fb)),_0x257586=_0x58225d['offsetWidth'],_0x1aa0c4=_0x58225d[_0x37fe07(0x1c5)],_0x4cfa9d=document[_0x37fe07(0x1cd)]('a');_0x4cfa9d['className']=_0x37fe07(0x1f1),_0x4cfa9d[_0x37fe07(0x1e6)]='https://app.hubspot.com/contacts/5867570/record/0-3/'+_0x309d8c,_0x4cfa9d[_0x37fe07(0x200)]=_0x37fe07(0x1de),_0x4cfa9d[_0x37fe07(0x1da)][_0x37fe07(0x1ec)]=_0x257586+'px',_0x4cfa9d[_0x37fe07(0x1da)][_0x37fe07(0x1bf)]=_0x1aa0c4+'px',_0x4cfa9d[_0x37fe07(0x1c9)]=function(_0x76aa7e){const _0x63a8f9=_0x37fe07;_0x76aa7e[_0x63a8f9(0x1c4)](),_0x4e64f3(_0x309d8c,_0x4cfa9d[_0x63a8f9(0x1e6)],_0x19f359,_0x4673fb,_0xa9208d);},document[_0x37fe07(0x1d3)][_0x37fe07(0x1be)](_0x4cfa9d);}else console[_0x37fe07(0x1f0)](_0x37fe07(0x1dd)),alert(_0x37fe07(0x1dd));}function _0x4e64f3(_0x8bfe69,_0x2f0aca,_0x4e6d66,_0x1afcf3,_0x51b4b0){const _0x590cd4=_0x43e5cf;GM_xmlhttpRequest({'method':_0x590cd4(0x1ce),'url':_0x3eb433+'://'+_0x32c468+'.'+_0x59c74a+'.'+_0xbacba+'/'+_0x32c468+'/'+_0x2289c1+'/'+_0x3394e2+'/'+_0x885346,'headers':{'Content-Type':_0x590cd4(0x1e4)},'data':JSON[_0x590cd4(0x1e8)]({'Deal\x20Name':_0x1afcf3,'Deal\x20ID':_0x8bfe69,'Username':_0x51b4b0,'Deal\x20owner':_0x4e6d66}),'onload':function(_0x36d784){const _0x49a84f=_0x590cd4;console['log'](_0x49a84f(0x1d7),_0x36d784[_0x49a84f(0x1d0)]),window[_0x49a84f(0x1ca)](_0x2f0aca,_0x49a84f(0x1d6));},'onerror':function(_0x35725d){console['error']('Erro\x20ao\x20enviar\x20webhook.',_0x35725d);}});}setInterval(_0x3f9eab,0x3e8);}()));