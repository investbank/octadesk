// ==UserScript==
// @name         Octadesk to Hubspot
// @author       Caio Rodrigo
// @version      v3.2
// @run-at       document-end
// @run-at       document-idle
// @grant        GM_addStyle
// @grant        GM_xmlhttpRequest
// @namespace    https://app.octadesk.com/
// @match        https://app.octadesk.com/chat/*
// @icon         https://app.octadesk.com/images/Icons/favicon.ico
// @updateURL    https://github.com/investbank/octadesk/main/section.user.js
// @downloadURL  https://raw.githubusercontent.com/investbank/octadesk/main/section.user.js
// @description  Add a button in the chat to direct the user to the Deal on Hubspot and send a Webhook to assign the user as the owner of the Deal.
// ==/UserScript==

function a0_0x2f6c(){const _0x50b28a=['645970052','6AcVjQu','offsetWidth','hubspot-button','catch','20kgyNpw','/chat/','224534171','448802705','1018719KmGkvd','602381622','490662201','7jrTQZw','952518frWLQs','preventDefault','://','Erro\x20ao\x20enviar\x20webhook.','includes','1834720jgeTzo','722364735','querySelector','11483048','25XUyXsv','635901253','627397232','654036494','/chat/empty','open','#octa-navigation\x20>\x20div\x20>\x20div\x20>\x20div._navigation-footer_18j2x_1\x20>\x20div\x20>\x20div._menu_9ygbx_1._connection-manager_wd63x_5\x20>\x20div\x20>\x20div\x20>\x20span._avatar-person-details__name_pn7wi_7\x20>\x20span','remove','121318700','703998366','3l74oda','a.hubspot-button{display:flex;margin-left:.5rem;border-top-left-radius:.75rem;border-bottom-left-radius:.75rem;--tw-bg-opacity:1;background-color:rgba(255,255,255,var(--tw-bg-opacity));--tw-shadow:0\x201px\x202px\x200\x20rgba(0,\x200,\x200,\x20.05);box-shadow:var(--tw-ring-offset-shadow,0\x200\x20#0000),var(--tw-ring-shadow,0\x200\x20#0000),var(--tw-shadow);font-family:Noto\x20Sans;font-size:.875rem;line-height:1.25rem;font-weight:500;--tw-text-opacity:1;color:rgba(79,84,100,var(--tw-text-opacity));position:absolute;top:.15%;right:.5%;z-index:1000;align-items:center;justify-content:center}','Webhook\x20enviado\x20com\x20sucesso.','416784450','2pDLDBb','Nome\x20do\x20negócio:\x20','responseText','Deal\x20ID:\x20','width','onclick','684130698','zapier','402277167','body','210548907','application/json','694540914','error','36711165','https://app.hubspot.com/contacts/5867570/record/0-3/','123577470','#container-chat\x20>\x20main\x20>\x20section\x20>\x20div._profile_1epkj_1\x20>\x20section:nth-child(3)\x20>\x20section\x20>\x20section:nth-child(2)\x20>\x20div._fields-container_1xd1d_5\x20>\x20div:nth-child(6)\x20>\x20div\x20>\x20div._fields-container__field__box_1xd1d_45\x20>\x20div\x20>\x20span','#container-chat\x20>\x20main\x20>\x20section\x20>\x20div._profile_1epkj_1\x20>\x20section:nth-child(1)','offsetHeight','8260879DOfKmD','468809336','height','Hubspot\x20ID\x20não\x20encontrado.','href','521418344','664278537','9904332GjCxlH','61052pvmvlR','402134392','Usuário\x20não\x20encontrado.','com','hooks','497313796','#container-chat\x20>\x20main\x20>\x20section\x20>\x20div._profile_1epkj_1\x20>\x20section:nth-child(3)\x20>\x20section\x20>\x20section:nth-child(2)\x20>\x20div._fields-container_1xd1d_5\x20>\x20div:nth-child(1)\x20>\x20div\x20>\x20div._fields-container__field__box_1xd1d_45\x20>\x20div\x20>\x20span','592619104','style','711822417','innerText','log','334303IukaeY','689176995'];a0_0x2f6c=function(){return _0x50b28a;};return a0_0x2f6c();}function a0_0xca13(_0x177b98,_0x137929){const _0x2f6cd2=a0_0x2f6c();return a0_0xca13=function(_0xca13db,_0x407e76){_0xca13db=_0xca13db-0x1ce;let _0x3f5c71=_0x2f6cd2[_0xca13db];return _0x3f5c71;},a0_0xca13(_0x177b98,_0x137929);}(function(_0xeec8e8,_0x246d5f){const _0x2b64fe=a0_0xca13,_0x217ce7=_0xeec8e8();while(!![]){try{const _0x5b43f1=-parseInt(_0x2b64fe(0x1ff))/0x1*(parseInt(_0x2b64fe(0x1d7))/0x2)+parseInt(_0x2b64fe(0x202))/0x3*(-parseInt(_0x2b64fe(0x1f3))/0x4)+-parseInt(_0x2b64fe(0x217))/0x5*(-parseInt(_0x2b64fe(0x20e))/0x6)+-parseInt(_0x2b64fe(0x20d))/0x7*(-parseInt(_0x2b64fe(0x213))/0x8)+parseInt(_0x2b64fe(0x20a))/0x9*(-parseInt(_0x2b64fe(0x206))/0xa)+-parseInt(_0x2b64fe(0x1eb))/0xb+parseInt(_0x2b64fe(0x1f2))/0xc;if(_0x5b43f1===_0x246d5f)break;else _0x217ce7['push'](_0x217ce7['shift']());}catch(_0x54aa53){_0x217ce7['push'](_0x217ce7['shift']());}}}(a0_0x2f6c,0x7b99a),(function(){'use strict';const _0x5d85d8=a0_0xca13;GM_addStyle(_0x5d85d8(0x1d4));const _0x16df86={'Caio\x20Rodrigo':_0x5d85d8(0x1e5),'Cintia\x20França':_0x5d85d8(0x1d1),'Jane\x20Silva':_0x5d85d8(0x1e7),'Jeverson\x20Leal':_0x5d85d8(0x1e1),'Diego\x20Mota':_0x5d85d8(0x208),'Luna\x20Rodrigues':'260593552','Julio\x20Cezar':_0x5d85d8(0x1f4),'Beatriz\x20Vitoria':_0x5d85d8(0x1df),'Raquel\x20Andressa':'416784447','Thalia\x20Sousa':_0x5d85d8(0x1d6),'Thiago\x20Keiki':_0x5d85d8(0x209),'Vinicius\x20Antunes':'466263204','Maria\x20Clara':_0x5d85d8(0x1ec),'Leandro\x20Soares':'482278797','Loara\x20Mikelly':_0x5d85d8(0x20c),'Maria\x20Barreto':_0x5d85d8(0x1f8),'Lucas\x20Ruotolo':_0x5d85d8(0x1f0),'Rosimeire\x20Pereira':'536328832','Jonathan\x20Rodrigues':'537759574','Mariana\x20Bergara':'587785904','Carlos\x20Henrique':_0x5d85d8(0x1fa),'Beatriz\x20Menezes':_0x5d85d8(0x20b),'Alef\x20Rodrigues':_0x5d85d8(0x219),'Matheus\x20Gomes':_0x5d85d8(0x218),'Barbara\x20Vieira':'639891100','Thalyta\x20Ramos':_0x5d85d8(0x201),'Igor\x20Gomes':_0x5d85d8(0x21a),'Paloma\x20Caramelo':_0x5d85d8(0x1f1),'Murilo\x20Nogueira':_0x5d85d8(0x1dd),'Othavio\x20Cordeiro':_0x5d85d8(0x200),'Natalia\x20Betti':_0x5d85d8(0x1e3),'Rafael\x20Spanopoulos':_0x5d85d8(0x1d2),'Yago\x20Fagundes':'710142215','Mariana\x20Mendonça':_0x5d85d8(0x1fc),'Gabriel\x20Leite':_0x5d85d8(0x214)},_0x104fb3='https',_0x3d788d=_0x5d85d8(0x1f7),_0x1fa738=_0x5d85d8(0x1de),_0x58e37b=_0x5d85d8(0x1f6),_0x162524=_0x5d85d8(0x205),_0x5d8691=_0x5d85d8(0x216),_0x51852d=_0x5d85d8(0x1d3);let _0x1feacc=location[_0x5d85d8(0x1ef)];function _0x242f4d(){const _0x36d830=_0x5d85d8;location[_0x36d830(0x1ef)][_0x36d830(0x212)](_0x36d830(0x207))&&!location[_0x36d830(0x1ef)][_0x36d830(0x212)](_0x36d830(0x21b))&&location[_0x36d830(0x1ef)]!==_0x1feacc&&(_0x1feacc=location[_0x36d830(0x1ef)],setTimeout(_0x94563d,0x3e8));}function _0x94563d(){const _0x49192d=_0x5d85d8,_0x565b7e=document[_0x49192d(0x215)]('a.hubspot-button');_0x565b7e&&_0x565b7e[_0x49192d(0x1d0)]();const _0x3bc7e9=document[_0x49192d(0x215)](_0x49192d(0x1e8)),_0x21a68c=document['querySelector'](_0x49192d(0x1f9)),_0x5351a8=document['querySelector'](_0x49192d(0x1cf));if(_0x3bc7e9&&_0x5351a8){const _0x19e5e5=_0x3bc7e9[_0x49192d(0x1fd)];console['log'](_0x49192d(0x1da)+_0x19e5e5);const _0x2a0aee=_0x5351a8[_0x49192d(0x1fd)];console[_0x49192d(0x1fe)]('Nome\x20de\x20usuário:\x20'+_0x2a0aee);const _0x3e9e1e=_0x21a68c['innerText'];console[_0x49192d(0x1fe)](_0x49192d(0x1d8)+_0x3e9e1e);const _0x3e4241=_0x16df86[_0x2a0aee];if(!_0x3e4241){console[_0x49192d(0x1fe)]('Usuário\x20não\x20encontrado.'),alert(_0x49192d(0x1f5));return;}const _0x29dbd3=document['querySelector'](_0x49192d(0x1e9)),_0x49f715=_0x29dbd3[_0x49192d(0x203)],_0x1e15bc=_0x29dbd3[_0x49192d(0x1ea)],_0xb0a499=document['createElement']('a');_0xb0a499['className']=_0x49192d(0x204),_0xb0a499[_0x49192d(0x1ef)]=_0x49192d(0x1e6)+_0x19e5e5,_0xb0a499[_0x49192d(0x1fd)]='Abrir\x20no\x20HubSpot',_0xb0a499[_0x49192d(0x1fb)][_0x49192d(0x1db)]=_0x49f715+'px',_0xb0a499['style'][_0x49192d(0x1ed)]=_0x1e15bc+'px',_0xb0a499[_0x49192d(0x1dc)]=function(_0x2bf611){const _0x121b6b=_0x49192d;_0x2bf611[_0x121b6b(0x20f)](),_0x34a126(_0x19e5e5,_0xb0a499[_0x121b6b(0x1ef)],_0x3e4241,_0x3e9e1e,_0x2a0aee);},document[_0x49192d(0x1e0)]['appendChild'](_0xb0a499);}else console['log']('Hubspot\x20ID\x20não\x20encontrado.'),alert(_0x49192d(0x1ee));}function _0x34a126(_0x1060a4,_0x6742da,_0x16aa75,_0x17d2d7,_0x147fa3){const _0x4fe337=_0x5d85d8;GM_xmlhttpRequest({'method':'POST','url':_0x104fb3+_0x4fe337(0x210)+_0x3d788d+'.'+_0x1fa738+'.'+_0x58e37b+'/'+_0x3d788d+'/'+_0x162524+'/'+_0x5d8691+'/'+_0x51852d,'headers':{'Content-Type':_0x4fe337(0x1e2)},'data':JSON['stringify']({'Deal\x20Name':_0x17d2d7,'Deal\x20ID':_0x1060a4,'Username':_0x147fa3,'Deal\x20owner':_0x16aa75}),'onload':function(_0x5e29a2){const _0x5540f3=_0x4fe337;console[_0x5540f3(0x1fe)](_0x5540f3(0x1d5),_0x5e29a2[_0x5540f3(0x1d9)]),window[_0x5540f3(0x1ce)](_0x6742da,'_blank');},'onerror':function(_0x28ab17){const _0x260204=_0x4fe337;console[_0x260204(0x1e4)](_0x260204(0x211),_0x28ab17);}});}setInterval(_0x242f4d,0x3e8);}()));