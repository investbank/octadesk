// ==UserScript==
// @version      v4
// @author       Caio Rodrigo
// @name         Octadesk to Hubspot
// @run-at       document-end
// @run-at       document-idle
// @grant        GM_addStyle
// @grant        GM_xmlhttpRequest
// @namespace    hhttps://app.octadesk.com/
// @match        https://app.octadesk.com/chat/*
// @icon         https://app.octadesk.com/images/Icons/favicon.ico
// @downloadURL  https://cdn.jsdelivr.net/gh/investbank/octadesk@main/section.js
// @updateURL    https://raw.githubusercontent.com/investbank/octadesk/main/section.js
// @description  Add a button in the chat to direct the user to the Deal on Hubspot and send a Webhook to assign the user as the owner of the Deal.
// ==/UserScript==

function a0_0x6b78(){const _0x295883=['587785904','offsetHeight','14gSeVMm','416784447','offsetWidth','536328832','a.hubspot-button','style','694540914','627397232','com','stringify','703998366','error','521418344','#octa-navigation\x20>\x20div\x20>\x20div\x20>\x20div._navigation-footer_18j2x_1\x20>\x20div\x20>\x20div._menu_9ygbx_1._connection-manager_wd63x_5\x20>\x20div\x20>\x20div\x20>\x20span._avatar-person-details__name_pn7wi_7\x20>\x20span','https','className','Usuário\x20não\x20encontrado.','416784450','466263204','href','open','210548907','448802705','402277167','722364735','3l74oda','383600WXDAnm','468809336','3885327yQkbzD','121318700','711822417','log','84vKDYxA','hubspot-button','Elemento\x20do\x20ID\x20do\x20cliente\x20não\x20encontrado.','3723786XmPKPu','responseText','111713puQsSc','querySelector','645970052','402134392','_blank','91968VFbEoS','application/json','appendChild','710142215','includes','592619104','1811262KTvDRC','12ahmMwr','30nzdXDD','6814160wrJHNQ','36711165','602381622','689176995','zapier','/chat/empty','#container-chat\x20>\x20main\x20>\x20section\x20>\x20div._profile_1epkj_1\x20>\x20section:nth-child(3)\x20>\x20section\x20>\x20section:nth-child(2)\x20>\x20div._fields-container_1xd1d_5\x20>\x20div:nth-child(6)\x20>\x20div\x20>\x20div._fields-container__field__box_1xd1d_45\x20>\x20div\x20>\x20span','innerText','Webhook\x20enviado\x20com\x20sucesso.','https://app.hubspot.com/contacts/5867570/record/0-3/','height'];a0_0x6b78=function(){return _0x295883;};return a0_0x6b78();}function a0_0xb671(_0x181320,_0x4343c3){const _0x6b7849=a0_0x6b78();return a0_0xb671=function(_0xb67186,_0xcc9c30){_0xb67186=_0xb67186-0x100;let _0x1518ac=_0x6b7849[_0xb67186];return _0x1518ac;},a0_0xb671(_0x181320,_0x4343c3);}(function(_0x1d4d90,_0x13c8e9){const _0x23c751=a0_0xb671,_0x463ab4=_0x1d4d90();while(!![]){try{const _0x2b3dd8=parseInt(_0x23c751(0x113))/0x1*(-parseInt(_0x23c751(0x11f))/0x2)+parseInt(_0x23c751(0x118))/0x3*(-parseInt(_0x23c751(0x10e))/0x4)+-parseInt(_0x23c751(0x108))/0x5+-parseInt(_0x23c751(0x11e))/0x6*(-parseInt(_0x23c751(0x12e))/0x7)+parseInt(_0x23c751(0x121))/0x8+-parseInt(_0x23c751(0x10a))/0x9+-parseInt(_0x23c751(0x120))/0xa*(-parseInt(_0x23c751(0x111))/0xb);if(_0x2b3dd8===_0x13c8e9)break;else _0x463ab4['push'](_0x463ab4['shift']());}catch(_0xd92bba){_0x463ab4['push'](_0x463ab4['shift']());}}}(a0_0x6b78,0x9e5b1),(function(){'use strict';const _0x1590e7=a0_0xb671;GM_addStyle('a.hubspot-button{display:flex;margin-left:.5rem;border-top-left-radius:.75rem;border-bottom-left-radius:.75rem;--tw-bg-opacity:1;background-color:rgba(255,255,255,var(--tw-bg-opacity));--tw-shadow:0\x201px\x202px\x200\x20rgba(0,\x200,\x200,\x20.05);box-shadow:var(--tw-ring-offset-shadow,0\x200\x20#0000),var(--tw-ring-shadow,0\x200\x20#0000),var(--tw-shadow);font-family:Noto\x20Sans;font-size:.875rem;line-height:1.25rem;font-weight:500;--tw-text-opacity:1;color:rgba(79,84,100,var(--tw-text-opacity));position:absolute;top:.15%;right:.5%;z-index:1000;align-items:center;justify-content:center}');const _0x5c356a={'Caio\x20Rodrigo':_0x1590e7(0x122),'Cintia\x20França':_0x1590e7(0x10b),'Jane\x20Silva':'123577470','Jeverson\x20Leal':_0x1590e7(0x103),'Diego\x20Mota':'224534171','Luna\x20Rodrigues':'260593552','Julio\x20Cezar':_0x1590e7(0x116),'Beatriz\x20Vitoria':_0x1590e7(0x105),'Raquel\x20Andressa':_0x1590e7(0x12f),'Thalia\x20Sousa':_0x1590e7(0x13f),'Thiago\x20Keiki':_0x1590e7(0x104),'Vinicius\x20Antunes':_0x1590e7(0x100),'Maria\x20Clara':_0x1590e7(0x109),'Leandro\x20Soares':'482278797','Loara\x20Mikelly':'490662201','Maria\x20Barreto':'497313796','Lucas\x20Ruotolo':_0x1590e7(0x13a),'Rosimeire\x20Pereira':_0x1590e7(0x131),'Jonathan\x20Rodrigues':'537759574','Mariana\x20Bergara':_0x1590e7(0x12c),'Carlos\x20Henrique':_0x1590e7(0x11d),'Beatriz\x20Menezes':_0x1590e7(0x123),'Alef\x20Rodrigues':_0x1590e7(0x135),'Matheus\x20Gomes':'635901253','Barbara\x20Vieira':'639891100','Thalyta\x20Ramos':_0x1590e7(0x115),'Igor\x20Gomes':'654036494','Paloma\x20Caramelo':'664278537','Murilo\x20Nogueira':'684130698','Othavio\x20Cordeiro':_0x1590e7(0x124),'Natalia\x20Betti':_0x1590e7(0x134),'Rafael\x20Spanopoulos':_0x1590e7(0x138),'Yago\x20Fagundes':_0x1590e7(0x11b),'Mariana\x20Mendonça':_0x1590e7(0x10c),'Gabriel\x20Leite':_0x1590e7(0x106)},_0x2fb537=_0x1590e7(0x13c),_0x1da9be='hooks',_0x2920cf=_0x1590e7(0x125),_0x5d8a2b=_0x1590e7(0x136),_0x21cdd0='catch',_0x226c43='11483048',_0x6fda1=_0x1590e7(0x107);let _0x4c16d5=location['href'];function _0x23489a(){const _0x4e5b8d=_0x1590e7;location[_0x4e5b8d(0x101)]['includes']('/chat/')&&!location['href'][_0x4e5b8d(0x11c)](_0x4e5b8d(0x126))&&location[_0x4e5b8d(0x101)]!==_0x4c16d5&&(_0x4c16d5=location[_0x4e5b8d(0x101)],setTimeout(_0x49dd56,0x3e8));}function _0x49dd56(){const _0x2d695d=_0x1590e7,_0x2d4a72=document['querySelector'](_0x2d695d(0x132));_0x2d4a72&&_0x2d4a72['remove']();const _0x116ccc=document[_0x2d695d(0x114)](_0x2d695d(0x127)),_0x49528e=document['querySelector']('#container-chat\x20>\x20main\x20>\x20section\x20>\x20div._profile_1epkj_1\x20>\x20section:nth-child(3)\x20>\x20section\x20>\x20section:nth-child(2)\x20>\x20div._fields-container_1xd1d_5\x20>\x20div:nth-child(1)\x20>\x20div\x20>\x20div._fields-container__field__box_1xd1d_45\x20>\x20div\x20>\x20span'),_0x1a2306=document[_0x2d695d(0x114)](_0x2d695d(0x13b));if(_0x116ccc&&_0x1a2306){const _0x1355b4=_0x116ccc[_0x2d695d(0x128)];console[_0x2d695d(0x10d)](_0x1355b4);const _0x33766a=_0x1a2306[_0x2d695d(0x128)];console[_0x2d695d(0x10d)](_0x33766a);const _0x56ffe6=_0x49528e['innerText'];console['log'](_0x56ffe6);const _0x3531c0=_0x5c356a[_0x33766a];if(!_0x3531c0){console[_0x2d695d(0x10d)](_0x2d695d(0x13e));return;}const _0x117497=document[_0x2d695d(0x114)]('#container-chat\x20>\x20main\x20>\x20section\x20>\x20div._profile_1epkj_1\x20>\x20section:nth-child(1)'),_0x3ac6f9=_0x117497[_0x2d695d(0x130)],_0x165e0b=_0x117497[_0x2d695d(0x12d)],_0x2e1144=document['createElement']('a');_0x2e1144[_0x2d695d(0x13d)]=_0x2d695d(0x10f),_0x2e1144['href']=_0x2d695d(0x12a)+_0x1355b4,_0x2e1144[_0x2d695d(0x128)]='Abrir\x20no\x20HubSpot',_0x2e1144[_0x2d695d(0x133)]['width']=_0x3ac6f9+'px',_0x2e1144[_0x2d695d(0x133)][_0x2d695d(0x12b)]=_0x165e0b+'px',_0x2e1144['onclick']=function(_0x3071df){_0x3071df['preventDefault'](),_0x5f3470(_0x1355b4,_0x2e1144['href'],_0x3531c0,_0x56ffe6,_0x33766a);},document['body'][_0x2d695d(0x11a)](_0x2e1144);}else console[_0x2d695d(0x10d)](_0x2d695d(0x110));}function _0x5f3470(_0x141c23,_0x37493a,_0x4a7284,_0x4c6c6a,_0x4b66a8){const _0x28fc03=_0x1590e7;GM_xmlhttpRequest({'method':'POST','url':_0x2fb537+'://'+_0x1da9be+'.'+_0x2920cf+'.'+_0x5d8a2b+'/'+_0x1da9be+'/'+_0x21cdd0+'/'+_0x226c43+'/'+_0x6fda1,'headers':{'Content-Type':_0x28fc03(0x119)},'data':JSON[_0x28fc03(0x137)]({'Deal\x20Name':_0x4c6c6a,'Deal\x20ID':_0x141c23,'Username':_0x4b66a8,'Deal\x20owner':_0x4a7284}),'onload':function(_0x3534e3){const _0x5afcc6=_0x28fc03;console[_0x5afcc6(0x10d)](_0x5afcc6(0x129),_0x3534e3[_0x5afcc6(0x112)]),window[_0x5afcc6(0x102)](_0x37493a,_0x5afcc6(0x117));},'onerror':function(_0x48d3b6){const _0xc0b98=_0x28fc03;console[_0xc0b98(0x139)]('Erro\x20ao\x20enviar\x20webhook.',_0x48d3b6);}});}setInterval(_0x23489a,0x3e8);}()));