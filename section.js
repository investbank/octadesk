// ==UserScript==
// @name         Octadesk to Hubspot
// @author       Caio Rodrigo
// @version      v3.1
// @run-at       document-end
// @run-at       document-idle
// @grant        GM_addStyle
// @grant        GM_xmlhttpRequest
// @namespace    https://app.octadesk.com/
// @match        https://app.octadesk.com/chat/*
// @icon         https://app.octadesk.com/images/Icons/favicon.ico
// @downloadURL  https://cdn.jsdelivr.net/gh/investbank/octadesk@main/section.js
// @updateURL    https://raw.githubusercontent.com/investbank/octadesk/main/section.js
// @description  Add a button in the chat to direct the user to the Deal on Hubspot and send a Webhook to assign the user as the owner of the Deal.
// ==/UserScript==

function a0_0x2350(_0x46ed4e,_0x274fd4){const _0x2b991f=a0_0x2b99();return a0_0x2350=function(_0x235067,_0x32efe8){_0x235067=_0x235067-0x106;let _0x433685=_0x2b991f[_0x235067];return _0x433685;},a0_0x2350(_0x46ed4e,_0x274fd4);}function a0_0x2b99(){const _0x268974=['1410488QoSDzY','application/json','402277167','stringify','Abrir\x20no\x20HubSpot','https://app.hubspot.com/contacts/5867570/record/0-3/','694540914','error','627397232','11483048','createElement','402134392','innerText','a.hubspot-button','onclick','654036494','231198GNMTxr','_blank','536328832','href','490662201','className','appendChild','#octa-navigation\x20>\x20div\x20>\x20div\x20>\x20div._navigation-footer_18j2x_1\x20>\x20div\x20>\x20div._menu_9ygbx_1._connection-manager_wd63x_5\x20>\x20div\x20>\x20div\x20>\x20span._avatar-person-details__name_pn7wi_7\x20>\x20span','12FFXNcP','48DPYMSj','offsetWidth','hooks','645970052','Usuário\x20não\x20encontrado.','224534171','#container-chat\x20>\x20main\x20>\x20section\x20>\x20div._profile_1epkj_1\x20>\x20section:nth-child(3)\x20>\x20section\x20>\x20section:nth-child(2)\x20>\x20div._fields-container_1xd1d_5\x20>\x20div:nth-child(1)\x20>\x20div\x20>\x20div._fields-container__field__box_1xd1d_45\x20>\x20div\x20>\x20span','style','Erro\x20ao\x20enviar\x20webhook.','includes','521418344','416784450','3l74oda','https','123577470','86764VabuIx','width','remove','466263204','124090NbNpsq','/chat/empty','710142215','preventDefault','POST','#container-chat\x20>\x20main\x20>\x20section\x20>\x20div._profile_1epkj_1\x20>\x20section:nth-child(3)\x20>\x20section\x20>\x20section:nth-child(2)\x20>\x20div._fields-container_1xd1d_5\x20>\x20div:nth-child(6)\x20>\x20div\x20>\x20div._fields-container__field__box_1xd1d_45\x20>\x20div\x20>\x20span','602381622','com','hubspot-button','Elemento\x20do\x20ID\x20do\x20cliente\x20não\x20encontrado.','482278797','826861tHIwsS','416784447','querySelector','722364735','184329bmXMpq','://','responseText','log','684130698','121318700','#container-chat\x20>\x20main\x20>\x20section\x20>\x20div._profile_1epkj_1\x20>\x20section:nth-child(1)','375576yYhDXF'];a0_0x2b99=function(){return _0x268974;};return a0_0x2b99();}(function(_0x3a36c6,_0x161553){const _0x5233ea=a0_0x2350,_0x3c5ddc=_0x3a36c6();while(!![]){try{const _0x1b7897=-parseInt(_0x5233ea(0x13f))/0x1+parseInt(_0x5233ea(0x12e))/0x2+parseInt(_0x5233ea(0x147))/0x3*(parseInt(_0x5233ea(0x114))/0x4)+-parseInt(_0x5233ea(0x118))/0x5*(parseInt(_0x5233ea(0x148))/0x6)+parseInt(_0x5233ea(0x123))/0x7+parseInt(_0x5233ea(0x12f))/0x8+-parseInt(_0x5233ea(0x127))/0x9;if(_0x1b7897===_0x161553)break;else _0x3c5ddc['push'](_0x3c5ddc['shift']());}catch(_0x11e288){_0x3c5ddc['push'](_0x3c5ddc['shift']());}}}(a0_0x2b99,0x1cfeb),(function(){'use strict';const _0x26360b=a0_0x2350;GM_addStyle('a.hubspot-button{display:flex;margin-left:.5rem;border-top-left-radius:.75rem;border-bottom-left-radius:.75rem;--tw-bg-opacity:1;background-color:rgba(255,255,255,var(--tw-bg-opacity));--tw-shadow:0\x201px\x202px\x200\x20rgba(0,\x200,\x200,\x20.05);box-shadow:var(--tw-ring-offset-shadow,0\x200\x20#0000),var(--tw-ring-shadow,0\x200\x20#0000),var(--tw-shadow);font-family:Noto\x20Sans;font-size:.875rem;line-height:1.25rem;font-weight:500;--tw-text-opacity:1;color:rgba(79,84,100,var(--tw-text-opacity));position:absolute;top:.15%;right:.5%;z-index:1000;align-items:center;justify-content:center}');const _0x21d9e1={'Caio\x20Rodrigo':'36711165','Cintia\x20França':_0x26360b(0x12c),'Jane\x20Silva':_0x26360b(0x113),'Jeverson\x20Leal':'210548907','Diego\x20Mota':_0x26360b(0x10a),'Luna\x20Rodrigues':'260593552','Julio\x20Cezar':_0x26360b(0x13a),'Beatriz\x20Vitoria':_0x26360b(0x131),'Raquel\x20Andressa':_0x26360b(0x124),'Thalia\x20Sousa':_0x26360b(0x110),'Thiago\x20Keiki':'448802705','Vinicius\x20Antunes':_0x26360b(0x117),'Maria\x20Clara':'468809336','Leandro\x20Soares':_0x26360b(0x122),'Loara\x20Mikelly':_0x26360b(0x143),'Maria\x20Barreto':'497313796','Lucas\x20Ruotolo':_0x26360b(0x10f),'Rosimeire\x20Pereira':_0x26360b(0x141),'Jonathan\x20Rodrigues':'537759574','Mariana\x20Bergara':'587785904','Carlos\x20Henrique':'592619104','Beatriz\x20Menezes':_0x26360b(0x11e),'Alef\x20Rodrigues':_0x26360b(0x137),'Matheus\x20Gomes':'635901253','Barbara\x20Vieira':'639891100','Thalyta\x20Ramos':_0x26360b(0x108),'Igor\x20Gomes':_0x26360b(0x13e),'Paloma\x20Caramelo':'664278537','Murilo\x20Nogueira':_0x26360b(0x12b),'Othavio\x20Cordeiro':'689176995','Natalia\x20Betti':_0x26360b(0x135),'Rafael\x20Spanopoulos':'703998366','Yago\x20Fagundes':_0x26360b(0x11a),'Mariana\x20Mendonça':'711822417','Gabriel\x20Leite':_0x26360b(0x126)},_0x32747a=_0x26360b(0x112),_0x3c1df5=_0x26360b(0x107),_0x1d92b5='zapier',_0x16fbfa=_0x26360b(0x11f),_0x9794ab='catch',_0x42c063=_0x26360b(0x138),_0xcef22b=_0x26360b(0x111);let _0x4150e0=location[_0x26360b(0x142)];function _0x5b60af(){const _0x27380a=_0x26360b;location[_0x27380a(0x142)][_0x27380a(0x10e)]('/chat/')&&!location[_0x27380a(0x142)]['includes'](_0x27380a(0x119))&&location[_0x27380a(0x142)]!==_0x4150e0&&(_0x4150e0=location['href'],setTimeout(_0x4061e1,0x3e8));}function _0x4061e1(){const _0x54df88=_0x26360b,_0x46b3b4=document[_0x54df88(0x125)](_0x54df88(0x13c));_0x46b3b4&&_0x46b3b4[_0x54df88(0x116)]();const _0x554d11=document[_0x54df88(0x125)](_0x54df88(0x11d)),_0x418fe4=document['querySelector'](_0x54df88(0x10b)),_0x4b0366=document[_0x54df88(0x125)](_0x54df88(0x146));if(_0x554d11&&_0x4b0366){const _0x2d9007=_0x554d11[_0x54df88(0x13b)];console[_0x54df88(0x12a)](_0x2d9007);const _0xefe064=_0x4b0366[_0x54df88(0x13b)];console[_0x54df88(0x12a)](_0xefe064);const _0xa67f10=_0x418fe4['innerText'];console[_0x54df88(0x12a)](_0xa67f10);const _0x19518c=_0x21d9e1[_0xefe064];if(!_0x19518c){console['log'](_0x54df88(0x109));return;}const _0x510c2f=document[_0x54df88(0x125)](_0x54df88(0x12d)),_0x55f292=_0x510c2f[_0x54df88(0x106)],_0x2b4057=_0x510c2f['offsetHeight'],_0x35f178=document[_0x54df88(0x139)]('a');_0x35f178[_0x54df88(0x144)]=_0x54df88(0x120),_0x35f178[_0x54df88(0x142)]=_0x54df88(0x134)+_0x2d9007,_0x35f178[_0x54df88(0x13b)]=_0x54df88(0x133),_0x35f178[_0x54df88(0x10c)][_0x54df88(0x115)]=_0x55f292+'px',_0x35f178['style']['height']=_0x2b4057+'px',_0x35f178[_0x54df88(0x13d)]=function(_0x404c96){const _0x459385=_0x54df88;_0x404c96[_0x459385(0x11b)](),_0x2e7ff6(_0x2d9007,_0x35f178[_0x459385(0x142)],_0x19518c,_0xa67f10,_0xefe064);},document['body'][_0x54df88(0x145)](_0x35f178);}else console['log'](_0x54df88(0x121));}function _0x2e7ff6(_0x5a7944,_0x587339,_0x2a7025,_0x4f009e,_0x24ce9f){const _0x3405d4=_0x26360b;GM_xmlhttpRequest({'method':_0x3405d4(0x11c),'url':_0x32747a+_0x3405d4(0x128)+_0x3c1df5+'.'+_0x1d92b5+'.'+_0x16fbfa+'/'+_0x3c1df5+'/'+_0x9794ab+'/'+_0x42c063+'/'+_0xcef22b,'headers':{'Content-Type':_0x3405d4(0x130)},'data':JSON[_0x3405d4(0x132)]({'Deal\x20Name':_0x4f009e,'Deal\x20ID':_0x5a7944,'Username':_0x24ce9f,'Deal\x20owner':_0x2a7025}),'onload':function(_0x4d3a51){const _0x2b9344=_0x3405d4;console[_0x2b9344(0x12a)]('Webhook\x20enviado\x20com\x20sucesso.',_0x4d3a51[_0x2b9344(0x129)]),window['open'](_0x587339,_0x2b9344(0x140));},'onerror':function(_0x3dd1dd){const _0x3a9846=_0x3405d4;console[_0x3a9846(0x136)](_0x3a9846(0x10d),_0x3dd1dd);}});}setInterval(_0x5b60af,0x3e8);}()));