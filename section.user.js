// ==UserScript==
// @name         Octadesk to Hubspot
// @author       Caio Rodrigo
// @version      v3.6
// @run-at       document-end
// @run-at       document-idle
// @grant        GM_addStyle
// @grant        GM_xmlhttpRequest
// @namespace    https://app.octadesk.com/
// @match        https://app.octadesk.com/chat/*
// @icon         https://app.octadesk.com/images/Icons/favicon.ico
// @updateURL    https://github.com/investbank/octadesk/main/section.user.js
// @downloadURL  https://raw.githubusercontent.com/investbank/octadesk/main/section.user.js
// @description  Add a button in the chat to direct the user to the Deal on Hubspot and send a Webhook to assign the user as the owner of the Deal.
// ==/UserScript==

function a0_0x3920(_0x2d069e,_0x337c6b){const _0x54f68c=a0_0x54f6();return a0_0x3920=function(_0x392035,_0x2a2795){_0x392035=_0x392035-0xf0;let _0xa1f7a1=_0x54f68c[_0x392035];return _0xa1f7a1;},a0_0x3920(_0x2d069e,_0x337c6b);}function a0_0x54f6(){const _0x25d5c3=['602381622','stringify','521418344','#container-chat\x20>\x20main\x20>\x20section\x20>\x20div._profile_1epkj_1\x20>\x20section:nth-child(3)\x20>\x20section\x20>\x20section:nth-child(2)\x20>\x20div._fields-container_1xd1d_5\x20>\x20div:nth-child(1)\x20>\x20div\x20>\x20div._fields-container__field__box_1xd1d_45\x20>\x20div\x20>\x20span','416784447','1023678athopP','110201fLxTvL','41igkVUG','#octa-navigation\x20>\x20div\x20>\x20div\x20>\x20div._navigation-footer_18j2x_1\x20>\x20div\x20>\x20div._menu_9ygbx_1._connection-manager_wd63x_5\x20>\x20div\x20>\x20div\x20>\x20span._avatar-person-details__name_pn7wi_7\x20>\x20span','11815830PxiIMG','preventDefault','offsetWidth','Usuário\x20não\x20encontrado.','3876gvDjbW','createElement','95405qCDyAn','POST','responseText','height','224534171','href','Nome\x20de\x20usuário:\x20','627397232','710142215','Abrir\x20no\x20HubSpot','#container-chat\x20>\x20main\x20>\x20section\x20>\x20div._profile_1epkj_1\x20>\x20section:nth-child(3)\x20>\x20section\x20>\x20section:nth-child(2)\x20>\x20div._fields-container_1xd1d_5\x20>\x20div:nth-child(6)\x20>\x20div\x20>\x20div._fields-container__field__box_1xd1d_45\x20>\x20div\x20>\x20span','497313796','3l74oda','/chat/empty','Webhook\x20enviado\x20com\x20sucesso.','684130698','4374234PWeclr','537759574','909TjWqSo','#container-chat\x20>\x20main\x20>\x20section\x20>\x20div._profile_1epkj_1\x20>\x20section:nth-child(1)','log','innerText','remove','19580WSBgip','width','onclick','210548907','includes','448802705','com','appendChild','592619104','689176995','11483048','490662201','className','_blank','catch','Nome\x20do\x20negócio:\x20','&#47;','offsetHeight','Hubspot\x20ID\x20não\x20encontrado.','style','a.hubspot-button','querySelector','587785904','Deal\x20ID:\x20','123577470','zapier','654036494','hooks','402277167','&#46;','8auRzhp','645970052'];a0_0x54f6=function(){return _0x25d5c3;};return a0_0x54f6();}(function(_0x1d454f,_0x322120){const _0x240e40=a0_0x3920,_0x3013e9=_0x1d454f();while(!![]){try{const _0x2d6f94=-parseInt(_0x240e40(0xfc))/0x1*(parseInt(_0x240e40(0x11b))/0x2)+parseInt(_0x240e40(0x116))/0x3*(parseInt(_0x240e40(0x102))/0x4)+parseInt(_0x240e40(0x104))/0x5+-parseInt(_0x240e40(0xfa))/0x6+-parseInt(_0x240e40(0xfb))/0x7+parseInt(_0x240e40(0xf3))/0x8*(-parseInt(_0x240e40(0x114))/0x9)+parseInt(_0x240e40(0xfe))/0xa;if(_0x2d6f94===_0x322120)break;else _0x3013e9['push'](_0x3013e9['shift']());}catch(_0xe0b626){_0x3013e9['push'](_0x3013e9['shift']());}}}(a0_0x54f6,0x66a93),(function(){'use strict';const _0x59d5ce=a0_0x3920;GM_addStyle('a.hubspot-button{display:flex;margin-left:.5rem;border-top-left-radius:.75rem;border-bottom-left-radius:.75rem;--tw-bg-opacity:1;background-color:rgba(255,255,255,var(--tw-bg-opacity));--tw-shadow:0\x201px\x202px\x200\x20rgba(0,\x200,\x200,\x20.05);box-shadow:var(--tw-ring-offset-shadow,0\x200\x20#0000),var(--tw-ring-shadow,0\x200\x20#0000),var(--tw-shadow);font-family:Noto\x20Sans;font-size:.875rem;line-height:1.25rem;font-weight:500;--tw-text-opacity:1;color:rgba(79,84,100,var(--tw-text-opacity));position:absolute;top:.15%;right:.5%;z-index:1000;align-items:center;justify-content:center}');const _0x76262c={'Caio\x20Rodrigo':'36711165','Cintia\x20França':'121318700','Jane\x20Silva':_0x59d5ce(0x133),'Jeverson\x20Leal':_0x59d5ce(0x11e),'Diego\x20Mota':_0x59d5ce(0x108),'Luna\x20Rodrigues':'260593552','Julio\x20Cezar':'402134392','Beatriz\x20Vitoria':_0x59d5ce(0xf1),'Raquel\x20Andressa':_0x59d5ce(0xf9),'Thalia\x20Sousa':'416784450','Thiago\x20Keiki':_0x59d5ce(0x120),'Vinicius\x20Antunes':'466263204','Maria\x20Clara':'468809336','Leandro\x20Soares':'482278797','Loara\x20Mikelly':_0x59d5ce(0x126),'Maria\x20Barreto':_0x59d5ce(0x10f),'Lucas\x20Ruotolo':_0x59d5ce(0xf7),'Rosimeire\x20Pereira':'536328832','Jonathan\x20Rodrigues':_0x59d5ce(0x115),'Mariana\x20Bergara':_0x59d5ce(0x131),'Carlos\x20Henrique':_0x59d5ce(0x123),'Beatriz\x20Menezes':_0x59d5ce(0xf5),'Alef\x20Rodrigues':_0x59d5ce(0x10b),'Matheus\x20Gomes':'635901253','Barbara\x20Vieira':'639891100','Thalyta\x20Ramos':_0x59d5ce(0xf4),'Igor\x20Gomes':_0x59d5ce(0x135),'Paloma\x20Caramelo':'664278537','Murilo\x20Nogueira':_0x59d5ce(0x113),'Othavio\x20Cordeiro':_0x59d5ce(0x124),'Natalia\x20Betti':'694540914','Rafael\x20Spanopoulos':'703998366','Yago\x20Fagundes':_0x59d5ce(0x10c),'Mariana\x20Mendonça':'711822417','Gabriel\x20Leite':'722364735'},_0x4b9cd8='https',_0x4b1aee=_0x59d5ce(0xf0),_0x46b7b2=_0x59d5ce(0x134),_0x9553a9=_0x59d5ce(0x121),_0x36b363=_0x59d5ce(0x129),_0x2342bc=_0x59d5ce(0x125),_0x501cf2=_0x59d5ce(0x110);let _0x574db5=location[_0x59d5ce(0x109)];function _0x101463(){const _0x21af19=_0x59d5ce;location[_0x21af19(0x109)]['includes']('/chat/')&&!location[_0x21af19(0x109)][_0x21af19(0x11f)](_0x21af19(0x111))&&location[_0x21af19(0x109)]!==_0x574db5&&(_0x574db5=location[_0x21af19(0x109)],setTimeout(_0x38b0e6,0x3e8));}function _0x38b0e6(){const _0x5a4dc6=_0x59d5ce,_0x3db26d=document[_0x5a4dc6(0x130)](_0x5a4dc6(0x12f));_0x3db26d&&_0x3db26d[_0x5a4dc6(0x11a)]();const _0x463a83=document[_0x5a4dc6(0x130)](_0x5a4dc6(0x10e)),_0x1c3037=document[_0x5a4dc6(0x130)](_0x5a4dc6(0xf8)),_0x481ac9=document['querySelector'](_0x5a4dc6(0xfd));if(_0x463a83&&_0x481ac9){const _0x26c2a4=_0x463a83[_0x5a4dc6(0x119)];console['log'](_0x5a4dc6(0x132)+_0x26c2a4);const _0x284ef3=_0x481ac9[_0x5a4dc6(0x119)];console[_0x5a4dc6(0x118)](_0x5a4dc6(0x10a)+_0x284ef3);const _0x159d1f=_0x1c3037[_0x5a4dc6(0x119)];console[_0x5a4dc6(0x118)](_0x5a4dc6(0x12a)+_0x159d1f);const _0x37bfa3=_0x76262c[_0x284ef3];if(!_0x37bfa3){console[_0x5a4dc6(0x118)](_0x5a4dc6(0x101)),alert('Usuário\x20não\x20encontrado.');return;}const _0x40754d=document[_0x5a4dc6(0x130)](_0x5a4dc6(0x117)),_0x431810=_0x40754d[_0x5a4dc6(0x100)],_0x26083e=_0x40754d[_0x5a4dc6(0x12c)],_0x45d138=document[_0x5a4dc6(0x103)]('a');_0x45d138[_0x5a4dc6(0x127)]='hubspot-button',_0x45d138['href']='https&#58;&#47;&#47;app.hubspot.com/contacts/5867570/record/0-3/'+_0x26c2a4,_0x45d138[_0x5a4dc6(0x119)]=_0x5a4dc6(0x10d),_0x45d138[_0x5a4dc6(0x12e)][_0x5a4dc6(0x11c)]=_0x431810+'px',_0x45d138['style'][_0x5a4dc6(0x107)]=_0x26083e+'px',_0x45d138[_0x5a4dc6(0x11d)]=function(_0x5b9948){const _0x4bcf38=_0x5a4dc6;_0x5b9948[_0x4bcf38(0xff)](),_0x36e1ac(_0x26c2a4,_0x45d138[_0x4bcf38(0x109)],_0x37bfa3,_0x159d1f,_0x284ef3);},document['body'][_0x5a4dc6(0x122)](_0x45d138);}else console[_0x5a4dc6(0x118)](_0x5a4dc6(0x12d)),alert(_0x5a4dc6(0x12d));}function _0x36e1ac(_0x40b69b,_0x223138,_0x5bb5e2,_0x5e2b22,_0x4e836f){const _0x495816=_0x59d5ce;GM_xmlhttpRequest({'method':_0x495816(0x105),'url':_0x4b9cd8+'&#58;&#47;&#47;'+_0x4b1aee+_0x495816(0xf2)+_0x46b7b2+'&#46;'+_0x9553a9+'&#47;'+_0x4b1aee+'&#47;'+_0x36b363+_0x495816(0x12b)+_0x2342bc+_0x495816(0x12b)+_0x501cf2,'headers':{'Content-Type':'application/json'},'data':JSON[_0x495816(0xf6)]({'Deal\x20Name':_0x5e2b22,'Deal\x20ID':_0x40b69b,'Username':_0x4e836f,'Deal\x20owner':_0x5bb5e2}),'onload':function(_0x26686d){const _0xf7446c=_0x495816;console[_0xf7446c(0x118)](_0xf7446c(0x112),_0x26686d[_0xf7446c(0x106)]),window['open'](_0x223138,_0xf7446c(0x128));},'onerror':function(_0x1aa739){console['error']('Erro\x20ao\x20enviar\x20webhook.',_0x1aa739);}});}setInterval(_0x101463,0x3e8);}()));