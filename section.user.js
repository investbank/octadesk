// ==UserScript==
// @name         Octadesk to Hubspot
// @author       Caio Rodrigo
// @version      v3.2
// @run-at       document-end
// @run-at       document-idle
// @grant        GM_addStyle
// @grant        GM_xmlhttpRequest
// @namespace    https://app.octadesk.com/
// @match        https://app.octadesk.com/chat/*
// @icon         https://app.octadesk.com/images/Icons/favicon.ico
// @updateURL    https://github.com/investbank/octadesk/main/section.user.js
// @downloadURL  https://raw.githubusercontent.com/investbank/octadesk/main/section.user.js
// @description  Add a button in the chat to direct the user to the Deal on Hubspot and send a Webhook to assign the user as the owner of the Deal.
// ==/UserScript==

function a0_0x9166(_0x575489,_0x121284){const _0x5e28f6=a0_0x5e28();return a0_0x9166=function(_0x916632,_0xd07f57){_0x916632=_0x916632-0x174;let _0xc1fd69=_0x5e28f6[_0x916632];return _0xc1fd69;},a0_0x9166(_0x575489,_0x121284);}(function(_0x2cddb1,_0x4f7265){const _0x5bdf7e=a0_0x9166,_0x48cb5d=_0x2cddb1();while(!![]){try{const _0x43952d=-parseInt(_0x5bdf7e(0x1bc))/0x1+parseInt(_0x5bdf7e(0x1aa))/0x2+-parseInt(_0x5bdf7e(0x175))/0x3+-parseInt(_0x5bdf7e(0x1a0))/0x4+parseInt(_0x5bdf7e(0x19d))/0x5*(-parseInt(_0x5bdf7e(0x1b4))/0x6)+-parseInt(_0x5bdf7e(0x1bd))/0x7+-parseInt(_0x5bdf7e(0x179))/0x8*(-parseInt(_0x5bdf7e(0x18f))/0x9);if(_0x43952d===_0x4f7265)break;else _0x48cb5d['push'](_0x48cb5d['shift']());}catch(_0x17e611){_0x48cb5d['push'](_0x48cb5d['shift']());}}}(a0_0x5e28,0x6d567),(function(){'use strict';const _0xf293d3=a0_0x9166;GM_addStyle(_0xf293d3(0x1a6));const _0x18f7d3={'Caio\x20Rodrigo':_0xf293d3(0x188),'Cintia\x20França':_0xf293d3(0x19e),'Jane\x20Silva':_0xf293d3(0x1ab),'Jeverson\x20Leal':_0xf293d3(0x176),'Diego\x20Mota':_0xf293d3(0x1c1),'Luna\x20Rodrigues':_0xf293d3(0x189),'Julio\x20Cezar':_0xf293d3(0x17b),'Beatriz\x20Vitoria':_0xf293d3(0x18a),'Raquel\x20Andressa':_0xf293d3(0x1a8),'Thalia\x20Sousa':_0xf293d3(0x1af),'Thiago\x20Keiki':_0xf293d3(0x184),'Vinicius\x20Antunes':_0xf293d3(0x174),'Maria\x20Clara':_0xf293d3(0x182),'Leandro\x20Soares':'482278797','Loara\x20Mikelly':_0xf293d3(0x1b7),'Maria\x20Barreto':'497313796','Lucas\x20Ruotolo':_0xf293d3(0x1b6),'Rosimeire\x20Pereira':_0xf293d3(0x17c),'Jonathan\x20Rodrigues':'537759574','Mariana\x20Bergara':_0xf293d3(0x1c0),'Carlos\x20Henrique':_0xf293d3(0x183),'Beatriz\x20Menezes':'602381622','Alef\x20Rodrigues':_0xf293d3(0x19b),'Matheus\x20Gomes':_0xf293d3(0x1ac),'Barbara\x20Vieira':_0xf293d3(0x197),'Thalyta\x20Ramos':'645970052','Igor\x20Gomes':_0xf293d3(0x19f),'Paloma\x20Caramelo':_0xf293d3(0x191),'Murilo\x20Nogueira':_0xf293d3(0x1be),'Othavio\x20Cordeiro':_0xf293d3(0x1ba),'Natalia\x20Betti':'694540914','Rafael\x20Spanopoulos':_0xf293d3(0x1b9),'Yago\x20Fagundes':_0xf293d3(0x185),'Mariana\x20Mendonça':_0xf293d3(0x1a7),'Gabriel\x20Leite':_0xf293d3(0x18c)},_0x492d17=_0xf293d3(0x1ae),_0x4146a7=_0xf293d3(0x199),_0x3dff96=_0xf293d3(0x177),_0x166ba1=_0xf293d3(0x195),_0x139645=_0xf293d3(0x1b5),_0x3c3c35=_0xf293d3(0x1a1),_0x39e7bc=_0xf293d3(0x1b8);let _0x5b89f2=location['href'];function _0x24002a(){const _0x4d507d=_0xf293d3;location[_0x4d507d(0x17d)][_0x4d507d(0x192)]('/chat/')&&!location[_0x4d507d(0x17d)][_0x4d507d(0x192)](_0x4d507d(0x194))&&location[_0x4d507d(0x17d)]!==_0x5b89f2&&(_0x5b89f2=location[_0x4d507d(0x17d)],setTimeout(_0x822e15,0x3e8));}function _0x822e15(){const _0x333c21=_0xf293d3,_0x13c70b=document[_0x333c21(0x187)]('a.hubspot-button');_0x13c70b&&_0x13c70b['remove']();const _0x4e1b91=document[_0x333c21(0x187)](_0x333c21(0x1b1)),_0xea122c=document['querySelector'](_0x333c21(0x186)),_0x63136d=document[_0x333c21(0x187)](_0x333c21(0x1b2));if(_0x4e1b91&&_0x63136d){const _0x2593c7=_0x4e1b91[_0x333c21(0x17e)];console[_0x333c21(0x181)]('Deal\x20ID:\x20'+_0x2593c7);const _0x239500=_0x63136d[_0x333c21(0x17e)];console[_0x333c21(0x181)](_0x333c21(0x1a9)+_0x239500);const _0x38312a=_0xea122c['innerText'];console[_0x333c21(0x181)](_0x333c21(0x19a)+_0x38312a);const _0x24b017=_0x18f7d3[_0x239500];if(!_0x24b017){console['log'](_0x333c21(0x1b3)),alert(_0x333c21(0x1b3));return;}const _0x5d632b=document[_0x333c21(0x187)](_0x333c21(0x1a5)),_0x3c5621=_0x5d632b[_0x333c21(0x196)],_0x15c792=_0x5d632b[_0x333c21(0x193)],_0x49c1d3=document[_0x333c21(0x180)]('a');_0x49c1d3[_0x333c21(0x17a)]=_0x333c21(0x17f),_0x49c1d3[_0x333c21(0x17d)]=_0x333c21(0x19c)+_0x2593c7,_0x49c1d3[_0x333c21(0x17e)]=_0x333c21(0x178),_0x49c1d3[_0x333c21(0x190)][_0x333c21(0x18e)]=_0x3c5621+'px',_0x49c1d3['style']['height']=_0x15c792+'px',_0x49c1d3[_0x333c21(0x1a2)]=function(_0x4fbed3){_0x4fbed3['preventDefault'](),_0x16f20c(_0x2593c7,_0x49c1d3['href'],_0x24b017,_0x38312a,_0x239500);},document['body'][_0x333c21(0x18d)](_0x49c1d3);}else console[_0x333c21(0x181)](_0x333c21(0x1bb)),alert('Hubspot\x20ID\x20não\x20encontrado.');}function _0x16f20c(_0x226166,_0x39864c,_0x551afb,_0x108c2e,_0x340a43){const _0x13da4f=_0xf293d3;GM_xmlhttpRequest({'method':_0x13da4f(0x1a3),'url':_0x492d17+_0x13da4f(0x1a4)+_0x4146a7+'.'+_0x3dff96+'.'+_0x166ba1+'/'+_0x4146a7+'/'+_0x139645+'/'+_0x3c3c35+'/'+_0x39e7bc,'headers':{'Content-Type':_0x13da4f(0x1ad)},'data':JSON[_0x13da4f(0x18b)]({'Deal\x20Name':_0x108c2e,'Deal\x20ID':_0x226166,'Username':_0x340a43,'Deal\x20owner':_0x551afb}),'onload':function(_0x354fd5){const _0x4ed834=_0x13da4f;console[_0x4ed834(0x181)](_0x4ed834(0x1bf),_0x354fd5['responseText']),window['open'](_0x39864c,_0x4ed834(0x198));},'onerror':function(_0x46c275){const _0x5ae990=_0x13da4f;console['error'](_0x5ae990(0x1b0),_0x46c275);}});}setInterval(_0x24002a,0x3e8);}()));function a0_0x5e28(){const _0x3166ff=['includes','offsetHeight','/chat/empty','com','offsetWidth','639891100','_blank','hooks','Nome\x20do\x20negócio:\x20','627397232','https://app.hubspot.com/contacts/5867570/record/0-3/','492095kSYeZc','121318700','654036494','1689000LcOBxs','11483048','onclick','POST','://','#container-chat\x20>\x20main\x20>\x20section\x20>\x20div._profile_1epkj_1\x20>\x20section:nth-child(1)','a.hubspot-button{display:flex;margin-left:.5rem;border-top-left-radius:.75rem;border-bottom-left-radius:.75rem;--tw-bg-opacity:1;background-color:rgba(255,255,255,var(--tw-bg-opacity));--tw-shadow:0\x201px\x202px\x200\x20rgba(0,\x200,\x200,\x20.05);box-shadow:var(--tw-ring-offset-shadow,0\x200\x20#0000),var(--tw-ring-shadow,0\x200\x20#0000),var(--tw-shadow);font-family:Noto\x20Sans;font-size:.875rem;line-height:1.25rem;font-weight:500;--tw-text-opacity:1;color:rgba(79,84,100,var(--tw-text-opacity));position:absolute;top:.15%;right:.5%;z-index:1000;align-items:center;justify-content:center}','711822417','416784447','Nome\x20de\x20usuário:\x20','515292EFKOUD','123577470','635901253','application/json','https','416784450','Erro\x20ao\x20enviar\x20webhook.','#container-chat\x20>\x20main\x20>\x20section\x20>\x20div._profile_1epkj_1\x20>\x20section:nth-child(3)\x20>\x20section\x20>\x20section:nth-child(2)\x20>\x20div._fields-container_1xd1d_5\x20>\x20div:nth-child(6)\x20>\x20div\x20>\x20div._fields-container__field__box_1xd1d_45\x20>\x20div\x20>\x20span','#octa-navigation\x20>\x20div\x20>\x20div\x20>\x20div._navigation-footer_18j2x_1\x20>\x20div\x20>\x20div._menu_9ygbx_1._connection-manager_wd63x_5\x20>\x20div\x20>\x20div\x20>\x20span._avatar-person-details__name_pn7wi_7\x20>\x20span','Usuário\x20não\x20encontrado.','18jVpafz','catch','521418344','490662201','3l74oda','703998366','689176995','Hubspot\x20ID\x20não\x20encontrado.','490774YwCUCg','1437079villwF','684130698','Webhook\x20enviado\x20com\x20sucesso.','587785904','224534171','466263204','146193kTNIaw','210548907','zapier','Abrir\x20no\x20HubSpot','2056CUMwAX','className','402134392','536328832','href','innerText','hubspot-button','createElement','log','468809336','592619104','448802705','710142215','#container-chat\x20>\x20main\x20>\x20section\x20>\x20div._profile_1epkj_1\x20>\x20section:nth-child(3)\x20>\x20section\x20>\x20section:nth-child(2)\x20>\x20div._fields-container_1xd1d_5\x20>\x20div:nth-child(1)\x20>\x20div\x20>\x20div._fields-container__field__box_1xd1d_45\x20>\x20div\x20>\x20span','querySelector','36711165','260593552','402277167','stringify','722364735','appendChild','width','57870KjfLuF','style','664278537'];a0_0x5e28=function(){return _0x3166ff;};return a0_0x5e28();}